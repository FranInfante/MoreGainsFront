<div class="container mt-5">
    <div class="row">
      <div class="col-md-6 order-md-1 order-2">
        <form [formGroup]="userForm" (ngSubmit)="updateUser()">
          <div class="mb-3">
            <label for="name" class="form-label">Nombre</label>
            <input type="text" id="name" class="form-control" formControlName="name">
            <div *ngIf="userForm.get('name')?.touched && userForm.get('name')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('name')?.errors?.['required']">El nombre es obligatorio.</small>
              <small class="text-danger" *ngIf="userForm.get('name')?.errors?.['minlength']">El nombre debe contener 3 caracteres como mínimo.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="surname" class="form-label">Apellido</label>
            <input type="text" id="surname" class="form-control" formControlName="surname">
            <div *ngIf="userForm.get('surname')?.touched && userForm.get('surname')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('surname')?.errors?.['required']">El apellido es obligatorio.</small>
              <small class="text-danger" *ngIf="userForm.get('surname')?.errors?.['minlength']">El apellido debe contener 3 caracteres como mínimo.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="username" class="form-label">Nombre de usuario</label>
            <input type="text" id="username" class="form-control" formControlName="username">
            <div *ngIf="userForm.get('username')?.touched && userForm.get('username')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('username')?.errors?.['required']">El nombre de usuario es obligatorio.</small>
              <small class="text-danger" *ngIf="userForm.get('username')?.errors?.['minlength']">El nombre de usuario debe tener al menos 5 caracteres.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Correo electrónico</label>
            <input type="email" id="email" class="form-control" formControlName="email">
            <div *ngIf="userForm.get('email')?.touched && userForm.get('email')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('email')?.errors?.['email']">Formato incorrecto.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="phone" class="form-label">Teléfono</label>
            <input type="text" id="phone" class="form-control" formControlName="phone">
            <div *ngIf="userForm.get('phone')?.touched && userForm.get('phone')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('phone')?.errors?.['pattern']">El número de teléfono debe tener 9 dígitos.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="address" class="form-label">Dirección</label>
            <input type="text" id="address" class="form-control" formControlName="address">
            <div *ngIf="userForm.get('address')?.touched && userForm.get('address')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('address')?.errors?.['required']">La dirección es obligatoria.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="dni" class="form-label">DNI</label>
            <input type="text" id="dni" class="form-control" formControlName="dni">
            <div *ngIf="userForm.get('dni')?.touched && userForm.get('dni')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('dni')?.errors?.['pattern']">formato incorrecto, 12345678A.</small>
            </div>
          </div>
          <div class="mb-3">
            <label for="postcode" class="form-label">Código Postal</label>
            <input type="text" id="postcode" class="form-control" formControlName="postcode">
            <div *ngIf="userForm.get('postcode')?.touched && userForm.get('postcode')?.invalid">
              <small class="text-danger" *ngIf="userForm.get('postcode')?.errors?.['pattern']">El código postal debe tener 5 dígitos.</small>
            </div>
          </div>
  
          <div class="d-flex justify-content-between mb-3">
            <button type="button" class="btn btn-warning me-2 text-white" id="btn-edit" (click)="toggleEdit()" *ngIf="!isEditing">Editar</button>
            <button type="submit" class="btn btn-warning me-2 text-white" id="btn-save-change" [disabled]="!userForm.valid" *ngIf="isEditing">Guardar Cambios</button>
            <button type="submit" class="btn btn-danger margin-left-2%" id="btn-cancel-edit" *ngIf="isEditing" (click)="toggleCancel()">Cancelar</button>
            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deactivateModal" *ngIf="!isEditing">Desactivar Cuenta</button>
          </div>
  
        </form>
      </div>
  
      <div class="col-md-6 order-md-2 order-1 d-flex flex-column align-items-center">
        <img [src]='userIcon' class="rounded-circle mb-3 user-img" alt="Imagen de Perfil">
        <h3>{{ user.username }}</h3>
      </div>
    </div>
  
  
    <div class="modal" tabindex="-1" id="deactivateModal" #deactivateModal>
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Confirmar Desactivación</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            ¿Estás seguro de que deseas desactivar esta cuenta?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-warning" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-danger" (click)="deactivateAccount()" data-bs-dismiss="modal">Desactivar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  